<!DOCTYPE html>
{% extends 'blog/base.html' %}
{% block body_block %}
    <h1>{{ article.title }}</h1>
    <div>{{ article.content|safe }}</div>

    <h2>Graph</h2>
    <form method="get" action="">
        <label for="file">Select CSV File:</label>
        <select name="file" id="file" onchange="this.form.submit()">
            <option value="">Select a file</option>
            {% for file in csv_files %}
                <option value="{{ file.id }}" {% if file.id|stringformat:"s" == selected_file %}selected{% endif %}>{{ file.name }}</option>
            {% endfor %}
        </select>
    </form>

    {% if selected_file %}
        <form method="get" action="">
            <input type="hidden" name="file" value="{{ selected_file }}">
            <label for="column">Select Column:</label>
            <select name="column" id="column" onchange="this.form.submit()">
                <option value="">Select a column</option>
                {% for column in columns %}
                    <option value="{{ column }}" {% if column == selected_column %}selected{% endif %}>{{ column }}</option>
                {% endfor %}
            </select>
        </form>
    {% endif %}

    {% if selected_file and selected_column %}
        <img src="{% url 'blog:plot_graph' %}?file={{ selected_file }}&column={{ selected_column }}" alt="Graph">
    {% endif %}
{% endblock %}